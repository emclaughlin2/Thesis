This section details the usage of individual calorimeter towers for EMCal, inner and outer HCal. 

\subsection{Tower energy reconstruction}
\label{sec:towerenergyreco}

Our analysis used the central production of calorimeter data in which waveforms above a set software zero suppression level are processed using the TEMPLATE mode of the CaloWaveformProcessing module. For Run 2024, tower-by-tower hardware zero suppression (ZS) thresholds were implemented to reduce data volume. Calorimeter tower waveforms with recorded pre-minus-post values below the ZS threshold only recorded the pre and post samples of the waveform and pre-minus-post values above the ZS threshold recorded the full 12 time sample waveform. During the fitting step of the calorimeter tower reconstruction, an additional software level ZS threshold is applied to correct for biases in the calorimeter energy distribution from noise waveforms. This ZS threshold is higher than the hardware level threshold and uniform across the full detector; for calorimeter tower waveforms which fall below this software level ZS threshold, the pre and post sample values of the waveform are used instead of fitting the waveform using the template fit method. For this anaylsis, the software level ZS thresholds were set to 100 ADC for the EMCal and 50 ADC for each of the HCals.

Both EMCal and HCal templates were created using beam data from early runs of Run 2024. The template fit has three free parameters: the pedestal, peak time and scale of the waveform, and the processing procedure returns these parameters plus a $\chi^{2}$ term which acts as a goodness of fit metric. More information on the template fit method can be found in the EMCal Year1 Calibration Note \cite{Seidlitz1}.

All three calorimeters, EMCal, IHCal and OHCal, are calibrated to the electromagnetic energy scale. For the EMCal, an $\eta$ dependent $\pi^{0}$ calibration is established using a subset of good beam runs. The run group specific calibration used for this analysis is measured using beam data from runs 54909 to 54920. More information regarding the specifics of the EMCal calibration can be found in the EMCal Year1 Calibration Note \cite{Seidlitz1}. The IHCal and OHCal are both calibrated to the EM energy scale using the minimum ionizing particle energy depositions from cosmic ray muons. The cosmics data used for this analysis's IHCal cosmics calibration were taken in a 30 day period that spans both  before and after the beam run period used for this analysis and the cosmics data used for this analysis's OHCal cosmics calibration where taken in a 5 day span directly after the beam run period used for this analysis. Therefore, it is expected that the detector conditions are fairly consistent between cosmics and beam running and any detector condition effects should be accounted for in the calibration from cosmics data. An additional HCal calibration step of a tower-slope correction is applied to account for inconsistencies in the cosmic data simulation; here a relative calibration is applied to HCal towers using the assumptions of $\phi$ symmetry and that the absolute cosmics-based calibrations of the HCal towers on the sides of the detectors with very high statistics are accurate.

An additional calibration was applied to the ZS tower energies to account for the ZS algorithm, waveform sample 6 - sample 0, underestimating the tower energy. The calorimeters on the whole are timed in at sample 6, however for multiple reasons including differences in trigger latching time samples, intra-sector cable lengths and tower distances to the collision points, on the towerâ€“by-tower level, a tower may not be timed in exactly at sample 6. While the template fit has little to no constraints within the waveform length on the signal timing when looking for the signal peak, the ZS algorithm expects the signal peak to be timed in exactly at sample 6. Therefore, a cross calibration is applied to the zero suppressed waveforms to account for shifts in the tower-by-tower mean time of signal peaks. This ZS cross calibration is determined using the ratio of $\frac{\overline{ADC}_{\text{Template fit}}}{\overline{ADC}_{\text{ZS}}}$ for well defined signals, signals with $ADC_{\text{Template fit}}$ = [200,2000] ADC for EMCal and $ADC_{\text{Template fit}}$ = [100,2000] ADC for HCals, extracted from the calorimeter fitting step of the calorimeter data production chain using the CaloFittingQA module. These cross calibration factors are determined on a tower-by-tower and run-by-run basis to account for tower-by-tower timing differences. The effect of tower reconstruction via the template fit versus ZS as well as the application of ZS cross calibration factors was extensively studied for the Run 2023 \dEtdeta measurement and is included in Appendix~\ref{sec:zerosuppression}.

Additionally, cross checks for the calorimeter sampling fraction has been performed to verify the response of the individual calorimeter towers and its $\eta$ dependence. It was determined that for this analysis, the uniform sampling fraction included in the G4\_HcalIn\_ref and G4\_HcalOut\_ref macros, which were determined from simulation particle gun studies, can be used, since the HCal absolute energy scale calibration is determined on the scintillator EM energy level and the same sampling fraction was applied to both simulation and data. Therefore, this sampling fraction value applied in both data and MC cancels out in the correction step when extracting measurements of the truth level \dEtdeta. These studies are detailed in Appendix~\ref{sec:SamplingFrac}. Furthermore, during analyzing the data, the effect of implementing the realistic support structure into the simulation software package was found to be crucial. The detailed studies of the impact of the support structures for this analysis can be found in Appendix.~\ref{sec:support_structure}.

\subsection{Bad Tower masking}
\label{sec:badtowermask}
For our final production of bad tower masks, we applied status bits from the CaloTowerStatus module of isHot, isBadChi2 and isNoCalib. More information on these status bits is included in the EMCal Year1 Calibration Note \cite{Seidlitz1}. As outlined in the calibration note \cite{Seidlitz1}, a tower is considered hot on a run by run basis, one way for a tower to be considered hot is if the 1\% of events with energy above a threshold have a high $\chi^2$ value for the template fit. In addition to these status bits, we also applied a masking to ensure that any towers that were dead, which we defined as read out exactly 0 energy for all events, were included in our mask. To do so, we selected for any channels with isGood flag that output an energy value of exactly 0 for all events in a particular run. Applying this additional component of the mask was necessary to ensure the calorimeter acceptance in the measurement from data and for the MC correction factors was the same. Additionally, towers with a high $\chi2$ value ($\chi2 > 10000$) that are not included in the run-by-run mask are masked on the single event level. Less than 1\% of events have a tower in any of the calorimeter layers with a high $\chi2$ value that is not already included in the run-by-run bad tower mask. A systematic study of the effect of masking these intermittently high $\chi2$ towers on the $\dEtdeta$ measurement found that the effect of masking these intermittently high $\chi2$ towers on the event by event level had negligible effects on the $\dEtdeta$ measurement. More details on these study are included in Section~\ref{hot_tower_syst}. The final contribution to our bad tower mask is the inclusion of a total of 5 towers in both the IHCal and OHCal which were found to at any point in Run 2024 data taking have half the expected signal height due to bent pins in the Meritec cables between the detector and ADC boards; due to the intermittent behavior of these half height signals, these towers were completely masked in the analysis.

For each run used in this analysis, the run by run bad tower mask is shown in Fig. \ref{fig:bad_tower_mask}.

\begin{figure}
    \centering
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/emcal_hot_tower_mask_54912.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ihcal_hot_tower_mask_54912.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ohcal_hot_tower_mask_54912.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/emcal_hot_tower_mask_54911.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ihcal_hot_tower_mask_54911.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ohcal_hot_tower_mask_54911.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/emcal_hot_tower_mask_54914.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ihcal_hot_tower_mask_54914.png}
    \includegraphics[width=0.32\textwidth]{Figures/hot_tower_masks/ohcal_hot_tower_mask_54914.png}
   \caption{Run-level bad tower masks for EMCal (left), IHCal (middle), OHCal (right) for nominal analysis run 54912 (top) and variation runs 54911 (middle) and 54914 (bottom). Only towers masked as bad are filled with a value of 1.}
    \label{fig:bad_tower_mask}
\end{figure}

\subsection{Vertex dependent $\eta$ correction}
The transverse energy per pseudorapidity unit, \dEtdeta, is calculated in a given $\eta$ interval based on the $\eta$ position of individual calorimeter towers in the lab frame.
To take into account the position of the collision vertex, the $\eta$ value in each tower is corrected event-by-event relative to the vertex position of the collision. 
In the runs used for this analysis, x \& y vertex reconstruction was not possible due to absent of tracker detector data, and therefore only a correction for the z-coordinate is obtained. In simulation and data, a corrected tower $\eta$ is calculated for each tower as
\begin{equation}
    \eta_{\text{corrected}} = \sinh^{-1}\left(\frac{z_{\text{new}}}{\sqrt{x^2_{\text{new}}+y^2_{\text{new}}}}\right),
\end{equation}
where
\begin{gather}
    x_{\text{new}} = x_{\text{tower}} - x_{\text{vertex}}
    \\
    y_{\text{new}} = y_{\text{tower}} - y_{\text{vertex}}
    \\
    z_{\text{new}} = z_{\text{tower}} - z_{\text{vertex}},
\end{gather}

and $x_{\text{tower}}$, $y_{\text{tower}}$, \& $z_{\text{tower}}$ are the $x$, $y$, \& $z$ positions of the towers with respect to the center of the detector. $x_{\text{vertex}}$, $y_{\text{vertex}}$, \& $z_{\text{vertex}}$ are the $x$, $y$, \& $z$ positions of the vertex. In data and simulation, $z_{\text{vertex}}$ is determined by reconstruction via the MBD.

With no $x$ or $y$ correction due to the lack of $x$ or $y$ vertex determination, this reduces to

\begin{equation}
    \eta_{\text{corrected}} = \sinh^{-1}\left(\frac{z_{\text{new}}}{\sqrt{x^2_{\text{tower}}+y^2_{\text{tower}}}}\right) = \sinh^{-1}\left(\frac{z_{\text{new}}}{r_{detector}}\right),
\end{equation}

with $r_{detector}$ the radius of the detector subsystem in question (EMCal, IHCal, or OHCal). The uncertainty in our event-by-event $\eta$ calculation due to no $x$ or $y$ vertex determination was found to be negligible for all calorimeters for $x$ or $y$ vertex shifts of up to 2cm. A schematic of this event by event $\eta$ correction is given in Fig. \ref{fig:eta_determination}.

\begin{figure}
    \centering
    \includegraphics[width=0.48\linewidth]{Figures/zvertex_reweighting/eta_determination.png}
    \caption{Event by event determination of calorimeter tower $\eta$ based on the z vertex of the event.}
    \label{fig:eta_determination}
\end{figure}

These new $\eta$ values are used as the values for determining $\ET$ as

\begin{equation}
    \ET = \frac{E_{\text{tower}}}{\cosh\eta_{\text{corrected}}}.
\end{equation}

$E_{\text{tower}}$ is the energy deposited in a given tower in data or simulation.